(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-096427ca"],{1906:function(t,e,a){},8528:function(t,e,a){"use strict";var i=a("1906"),s=a.n(i);s.a},a7ad:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"publish-wrapper"},[a("div",{staticClass:"title"},[t._v(t._s(t.select.name[t.select.num])+":")]),a("div",{staticClass:"form"},[a("div",{staticClass:"img"},[a("div",{ref:"preview",staticClass:"preview",on:{click:function(e){return t.deleteCanvas(e)}}}),t.form.img_file[0]?t._e():a("div",{staticClass:"tips"},[t._v("注意：默认会截取图片中央为展示图片，上传后的图片再次点击删除")]),a("div",{staticClass:"form-src"},[a("span",{staticClass:"text"},[t._v("点击上传图片")]),a("input",{staticClass:"btn",attrs:{accept:"image/*",type:"file"},on:{change:function(e){return t.previewImg(e)}}})])]),a("label",{staticClass:"form-item",attrs:{for:"title"}},[a("span",[t._v("商品名称：")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.title,expression:"form.title"}],staticClass:"text",attrs:{type:"text",id:"title"},domProps:{value:t.form.title},on:{input:function(e){e.target.composing||t.$set(t.form,"title",e.target.value)}}})]),a("label",{staticClass:"form-item",attrs:{for:"desc"}},[a("span",[t._v("商品描述：")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.desc,expression:"form.desc"}],staticClass:"textarea",attrs:{id:"desc"},domProps:{value:t.form.desc},on:{input:function(e){e.target.composing||t.$set(t.form,"desc",e.target.value)}}})]),a("label",{staticClass:"form-item",attrs:{for:"price"}},[a("span",[t._v("商品价格：")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.price,expression:"form.price"}],staticClass:"text",attrs:{type:"number",id:"price"},domProps:{value:t.form.price},on:{input:function(e){e.target.composing||t.$set(t.form,"price",e.target.value)}}})]),a("label",{staticClass:"form-item",attrs:{for:"max_count"}},[a("span",[t._v("商品库存：")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.max_count,expression:"form.max_count"}],staticClass:"text",attrs:{type:"number",id:"max_count"},domProps:{value:t.form.max_count},on:{input:function(e){e.target.composing||t.$set(t.form,"max_count",e.target.value)}}})]),a("button",{staticClass:"submit",on:{click:t.publish}},[t._v("发布商品")])])])},s=[],r=(a("ac6a"),{props:{select:{type:Object}},data:function(){return{form:{img_file:[],title:"",desc:"",price:"",max_count:""}}},methods:{publish:function(){var t=this,e=this.$checkEmpty(this.form);if(e)switch(e){case"img_file":this.$store.commit("tip",{reason:"请发布商品图片至少一张",color:"red",update:new Date});break;case"title":this.$store.commit("tip",{reason:"请输入商品名称",color:"red",update:new Date});break;case"desc":this.$store.commit("tip",{reason:"请输入商品描述内容",color:"red",update:new Date});break;case"price":this.$store.commit("tip",{reason:"请输入商品价格",color:"red",update:new Date});break;case"max_count":this.$store.commit("tip",{reason:"请输入商品库存",color:"red",update:new Date});break}else{var a=new FormData;this.form.img_file.forEach(function(t){a.append("img_file",t)}),a.append("select",this.select.num),a.append("desc",this.form.desc),a.append("price",this.form.price),a.append("max_count",this.form.max_count),a.append("title",this.form.title),a.append("time",this.$now()),this.$http.post("/goods",a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){t.$jwt(e.data)&&t.$store.commit("tip",{reason:e.data.reason,color:"green",update:new Date})})}},deleteAll:function(){for(var t in this.form)this.form[t]="",this.form["img_file"]=[];this.$refs.preview.innerHTML=""},deleteCanvas:function(t){this.$refs.preview.removeChild(t.target)},previewImg:function(t){var e=t.target.files[0],a=this;t&&window.FileReader||alert("您的设备不支持图片预览功能，如需该功能请升级您的设备！");var i=new FileReader;e&&i.readAsDataURL(e);var s=document.createElement("canvas"),r=this.$refs.preview,o=new Image,n=s.getContext("2d");i.onload=function(){o.src=this.result,o.onload=function(){s.width=300,s.height=300;var t=[o.width,o.height],e=t[0],i=t[1],c=0,m=0,l=0,p=0;e>=i?(m=0,p=i,c=(e-i)/2,l=c+i):(c=0,l=e,m=(i-e)/2,p=m+e);var d=[c,m,l,p].map(function(t){return Math.floor(t)});n.drawImage(o,d[0],d[1],d[2],d[3],0,0,300,300),r.appendChild(s),s.toBlob(function(t){a.form.img_file.push(t)},"image/jpeg")}}}}}),o=r,n=(a("8528"),a("2877")),c=Object(n["a"])(o,i,s,!1,null,"66cbd9b4",null);e["default"]=c.exports}}]);
//# sourceMappingURL=chunk-096427ca.a4e6860b.js.map